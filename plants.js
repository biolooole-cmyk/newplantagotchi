/* =====================================================
   PLANTAGOTCHI — PLANTS.JS
   Дані про рослини: стадії росту та оптимальні умови
   ===================================================== */

/* =====================================================
   СТРУКТУРА ДАНИХ
   
   Кожна рослина має:
   - id: унікальний ідентифікатор
   - name: назва українською
   - stages: масив стадій росту (назви файлів зображень)
   - optimal: оптимальні діапазони параметрів
     - water: [мін, макс] - рівень вологості (0-100)
     - light: [мін, макс] - рівень освітлення (0-100)
     - temp: [мін, макс] - температура (°C)
     - nutrients: діапазони для N, P, K (0-100)
   ===================================================== */

const plants = {
  
  /* ===========================
     КВАСОЛЯ (Phaseolus vulgaris)
     Швидкорослина однорічна рослина
     =========================== */
  bean: {
    id: "bean",
    name: "Квасоля",
    description: "Швидкорослина бобова культура, чутлива до температури та вологості",
    
    // Стадії розвитку
    stages: ["seed", "sprout", "plant", "flower", "fruit"],
    
    // Оптимальні умови
    optimal: {
      water: [60, 80],      // Помірно волога
      light: [65, 85],      // Яскраве освітлення
      temp: [18, 26],       // Тепло, не переносить холод
      nutrients: {
        N: [40, 60],        // Високі потреби в азоті (ріст листя)
        P: [30, 50],        // Середні потреби у фосфорі (корені)
        K: [35, 55]         // Середньо-високі потреби в калії (плодоношення)
      }
    },
    
    // Особливості догляду
    tips: {
      watering: "Регулярний полив, не допускати пересихання",
      temperature: "Чутлива до холоду, оптимально 20-24°C",
      light: "Потребує багато світла для швидкого росту",
      nutrients: "Високі потреби в азоті під час росту листя"
    }
  },

  /* ===========================
     ТРОЯНДА (Rosa)
     Багаторічна квіткова рослина
     =========================== */
  rose: {
    id: "rose",
    name: "Троянда",
    description: "Вибаглива декоративна рослина, потребує ретельного догляду",
    
    // Стадії розвитку
    stages: ["seed", "sprout", "plant", "flower", "fruit"],
    
    // Оптимальні умови
    optimal: {
      water: [50, 70],      // Помірна вологість
      light: [70, 90],      // Дуже яскраве освітлення
      temp: [15, 24],       // Прохолодніше, ніж квасоля
      nutrients: {
        N: [35, 55],        // Середньо-високі потреби в азоті
        P: [40, 60],        // Високі потреби у фосфорі (цвітіння)
        K: [40, 60]         // Високі потреби в калії (стійкість)
      }
    },
    
    // Особливості догляду
    tips: {
      watering: "Рівномірний полив, уникати перезволоження",
      temperature: "Переносить прохолоду, але не морози",
      light: "Потребує максимум світла для багатого цвітіння",
      nutrients: "Збалансоване живлення, особливо фосфор для квітів"
    }
  },

  /* ===========================
     М'ЯТА (Mentha)
     Багаторічна ароматична трава
     =========================== */
  mint: {
    id: "mint",
    name: "М'ята",
    description: "Невибаглива ароматична рослина, стійка до різних умов",
    
    // Стадії розвитку
    stages: ["seed", "sprout", "plant", "flower", "fruit"],
    
    // Оптимальні умови
    optimal: {
      water: [65, 85],      // Волога, любить воду
      light: [50, 75],      // Толерантна до напівтіні
      temp: [16, 25],       // Широкий температурний діапазон
      nutrients: {
        N: [45, 65],        // Високі потреби в азоті (листя)
        P: [25, 45],        // Низькі потреби у фосфорі
        K: [30, 50]         // Середні потреби в калії
      }
    },
    
    // Особливості догляду
    tips: {
      watering: "Любить вологу, рясний полив влітку",
      temperature: "Стійка до коливань температури",
      light: "Може рости в напівтіні, але краще на світлі",
      nutrients: "Основна потреба - азот для пишного листя"
    }
  }
};

/* =====================================================
   ДОДАТКОВА ІНФОРМАЦІЯ ПРО СТАДІЇ РОСТУ
   ===================================================== */

const growthStages = {
  seed: {
    name: "Насіння",
    description: "Початкова стадія, насіння в стані спокою",
    duration: "1-3 дні"
  },
  sprout: {
    name: "Паросток",
    description: "Проростання, перші корінці та паростки",
    duration: "3-7 днів"
  },
  plant: {
    name: "Рослина",
    description: "Активний ріст, розвиток листя та стебла",
    duration: "7-14 днів"
  },
  flower: {
    name: "Цвітіння",
    description: "Формування бутонів та квітів",
    duration: "7-10 днів"
  },
  fruit: {
    name: "Плодоношення",
    description: "Утворення плодів або насіння",
    duration: "7-14 днів"
  }
};

/* =====================================================
   ІНФОРМАЦІЯ ПРО ПОЖИВНІ РЕЧОВИНИ
   ===================================================== */

const nutrientInfo = {
  N: {
    name: "Азот (N)",
    role: "Ріст листя та стебел, зелена маса",
    deficiency: "Жовтіння листя, повільний ріст",
    excess: "Надмірний ріст листя, слабке цвітіння"
  },
  P: {
    name: "Фосфор (P)",
    role: "Розвиток коренів, цвітіння, плодоношення",
    deficiency: "Фіолетовий відтінок листя, слабкі корені",
    excess: "Блокування інших елементів"
  },
  K: {
    name: "Калій (K)",
    role: "Загальна стійкість, якість плодів, імунітет",
    deficiency: "Краї листя буріють, слабка стійкість до хвороб",
    excess: "Блокування магнію та кальцію"
  }
};

/* =====================================================
   ФУНКЦІЇ ДОПОМОГИ
   ===================================================== */

// Отримати інформацію про рослину за ID
function getPlant(plantId) {
  return plants[plantId] || null;
}

// Перевірити, чи параметр в оптимальному діапазоні
function isOptimal(value, range) {
  return value >= range[0] && value <= range[1];
}

// Отримати всі доступні рослини
function getAllPlants() {
  return Object.values(plants);
}

// Отримати назву стадії українською
function getStageName(stageKey) {
  return growthStages[stageKey]?.name || stageKey;
}

// Отримати опис поживної речовини
function getNutrientInfo(nutrient) {
  return nutrientInfo[nutrient] || null;
}

/* =====================================================
   ВАЛІДАЦІЯ ДАНИХ
   ===================================================== */

// Перевірка коректності структури даних рослин
function validatePlants() {
  const errors = [];
  
  Object.entries(plants).forEach(([key, plant]) => {
    // Перевірка ID
    if (plant.id !== key) {
      errors.push(`Plant ${key}: ID mismatch`);
    }
    
    // Перевірка стадій
    if (!plant.stages || plant.stages.length === 0) {
      errors.push(`Plant ${key}: No stages defined`);
    }
    
    // Перевірка оптимальних умов
    if (!plant.optimal) {
      errors.push(`Plant ${key}: No optimal conditions`);
    } else {
      // Перевірка діапазонів
      ['water', 'light', 'temp'].forEach(param => {
        if (!Array.isArray(plant.optimal[param]) || plant.optimal[param].length !== 2) {
          errors.push(`Plant ${key}: Invalid ${param} range`);
        }
      });
      
      // Перевірка NPK
      ['N', 'P', 'K'].forEach(nutrient => {
        if (!plant.optimal.nutrients[nutrient] || plant.optimal.nutrients[nutrient].length !== 2) {
          errors.push(`Plant ${key}: Invalid ${nutrient} range`);
        }
      });
    }
  });
  
  if (errors.length > 0) {
    console.error('Plant data validation errors:', errors);
    return false;
  }
  
  console.log('✅ Plant data validated successfully');
  return true;
}

// Запустити валідацію при завантаженні
if (typeof window !== 'undefined') {
  window.addEventListener('DOMContentLoaded', () => {
    validatePlants();
  });
}

/* =====================================================
   ЕКСПОРТ (для можливого використання як модуль)
   ===================================================== */

if (typeof module !== 'undefined' && module.exports) {
  module.exports = {
    plants,
    growthStages,
    nutrientInfo,
    getPlant,
    isOptimal,
    getAllPlants,
    getStageName,
    getNutrientInfo,
    validatePlants
  };
}